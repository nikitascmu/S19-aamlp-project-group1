for (j in seq(1:dim(CAP_PO_min_prices_corrected)[1])){
cost_sim[j,] <- sample(CAP_PO_min_prices_corrected[j,], size=dim(CAP_PO_min_prices_corrected)[2], replace=T)
}
cost_sim
CAP_PO_min_prices_corrected
bootstrap_cost(CAP_PO_min_prices_corrected, CAP_PO_loc)
bootstrap_cost(CAP_IV_min_prices_corrected, CAP_IV_loc)
bootstrap_cost(UTI_PO_min_prices_corrected, UTI_PO_loc)
bootstrap_cost(UTI_IV_min_prices_corrected, UTI_IV_loc)
bootstrap_cost(Cellulitis_PO_min_prices_corrected, Cellulitis_PO_loc)
bootstrap_cost(Cellulitis_IV_min_prices_corrected, Cellulitis_IV_loc)
CI95Print <- function(means, stdevs){
return(c((means - (qnorm(0.975)*stdevs/sqrt(1000))), (means + (qnorm(0.975)*stdevs/sqrt(1000)))))
}
CI95Print(bootstrap_cost(CAP_PO_min_prices_corrected, CAP_PO_loc)[1], bootstrap_cost(CAP_PO_min_prices_corrected, CAP_PO_loc)[2])
CI95Print(bootstrap_cost(CAP_IV_min_prices_corrected, CAP_IV_loc)[1], bootstrap_cost(CAP_IV_min_prices_corrected, CAP_IV_loc)[2])
CI95Print(bootstrap_cost(UTI_PO_min_prices_corrected, UTI_PO_loc)[1], bootstrap_cost(UTI_PO_min_prices_corrected, UTI_PO_loc)[2])
CI95Print(bootstrap_cost(UTI_IV_min_prices_corrected, UTI_IV_loc)[1], bootstrap_cost(UTI_IV_min_prices_corrected, UTI_IV_loc)[2])
CI95Print(bootstrap_cost(Cellulitis_PO_min_prices_corrected, Cellulitis_PO_loc)[1], bootstrap_cost(Cellulitis_PO_min_prices_corrected, Cellulitis_PO_loc)[2])
CI95Print(bootstrap_cost(Cellulitis_IV_min_prices_corrected, Cellulitis_IV_loc)[1], bootstrap_cost(Cellulitis_IV_min_prices_corrected, Cellulitis_IV_loc)[2])
# Make matrix to display data
Freq_CI_costreport <- matrix(0, 6, 3)
rownames(Freq_CI_costre1port) <- c("CAP PO", "CAP IV", "UTI PO", "UTI IV", "Cellulitis PO", "Cellulitis IV")
colnames(Freq_CI_costreport) <- c("Frequency of Cheapest Antibiotic Recommendation", "CI", "CI")
Freq_CI_costreport[1,1] <- cheapest_isrecc(CAP_PO_min_prices_corrected, CAP_PO_loc)
Freq_CI_costreport[2,1] <- cheapest_isrecc(CAP_IV_min_prices_corrected, CAP_IV_loc)
Freq_CI_costreport[3,1] <- cheapest_isrecc(UTI_PO_min_prices_corrected, UTI_PO_loc)
Freq_CI_costreport[4,1] <- cheapest_isrecc(UTI_IV_min_prices_corrected, UTI_IV_loc)
Freq_CI_costreport[5,1] <- cheapest_isrecc(Cellulitis_PO_min_prices_corrected, Cellulitis_PO_loc)
Freq_CI_costreport[6,1] <- cheapest_isrecc(Cellulitis_IV_min_prices_corrected, Cellulitis_IV_loc)
Freq_CI_costreport[1, 2:3] <- CI95Print(bootstrap_cost(CAP_PO_min_prices_corrected, CAP_PO_loc)[1], bootstrap_cost(CAP_PO_min_prices_corrected, CAP_PO_loc)[2])
Freq_CI_costreport[2, 2:3] <- CI95Print(bootstrap_cost(CAP_IV_min_prices_corrected, CAP_IV_loc)[1], bootstrap_cost(CAP_IV_min_prices_corrected, CAP_IV_loc)[2])
Freq_CI_costreport[3, 2:3] <- CI95Print(bootstrap_cost(UTI_PO_min_prices_corrected, UTI_PO_loc)[1], bootstrap_cost(UTI_PO_min_prices_corrected, UTI_PO_loc)[2])
Freq_CI_costreport[4, 2:3] <- CI95Print(bootstrap_cost(UTI_IV_min_prices_corrected, UTI_IV_loc)[1], bootstrap_cost(UTI_IV_min_prices_corrected, UTI_IV_loc)[2])
Freq_CI_costreport[5, 2:3] <- CI95Print(bootstrap_cost(Cellulitis_PO_min_prices_corrected, Cellulitis_PO_loc)[1], bootstrap_cost(Cellulitis_PO_min_prices_corrected, Cellulitis_PO_loc)[2])
Freq_CI_costreport[6, 2:3] <- CI95Print(bootstrap_cost(Cellulitis_IV_min_prices_corrected, Cellulitis_IV_loc)[1], bootstrap_cost(Cellulitis_IV_min_prices_corrected, Cellulitis_IV_loc)[2])
Freq_CI_costreport
Freq_CI_costreport <- matrix(0, 6, 3)
rownames(Freq_CI_costreport) <- c("CAP PO", "CAP IV", "UTI PO", "UTI IV", "Cellulitis PO", "Cellulitis IV")
colnames(Freq_CI_costreport) <- c("Frequency of Cheapest Antibiotic Recommendation", "CI", "CI")
Freq_CI_costreport[1,1] <- cheapest_isrecc(CAP_PO_min_prices_corrected, CAP_PO_loc)
Freq_CI_costreport[2,1] <- cheapest_isrecc(CAP_IV_min_prices_corrected, CAP_IV_loc)
Freq_CI_costreport[3,1] <- cheapest_isrecc(UTI_PO_min_prices_corrected, UTI_PO_loc)
Freq_CI_costreport[4,1] <- cheapest_isrecc(UTI_IV_min_prices_corrected, UTI_IV_loc)
Freq_CI_costreport[5,1] <- cheapest_isrecc(Cellulitis_PO_min_prices_corrected, Cellulitis_PO_loc)
Freq_CI_costreport[6,1] <- cheapest_isrecc(Cellulitis_IV_min_prices_corrected, Cellulitis_IV_loc)
Freq_CI_costreport[1, 2:3] <- CI95Print(bootstrap_cost(CAP_PO_min_prices_corrected, CAP_PO_loc)[1], bootstrap_cost(CAP_PO_min_prices_corrected, CAP_PO_loc)[2])
Freq_CI_costreport[2, 2:3] <- CI95Print(bootstrap_cost(CAP_IV_min_prices_corrected, CAP_IV_loc)[1], bootstrap_cost(CAP_IV_min_prices_corrected, CAP_IV_loc)[2])
Freq_CI_costreport[3, 2:3] <- CI95Print(bootstrap_cost(UTI_PO_min_prices_corrected, UTI_PO_loc)[1], bootstrap_cost(UTI_PO_min_prices_corrected, UTI_PO_loc)[2])
Freq_CI_costreport[4, 2:3] <- CI95Print(bootstrap_cost(UTI_IV_min_prices_corrected, UTI_IV_loc)[1], bootstrap_cost(UTI_IV_min_prices_corrected, UTI_IV_loc)[2])
Freq_CI_costreport[5, 2:3] <- CI95Print(bootstrap_cost(Cellulitis_PO_min_prices_corrected, Cellulitis_PO_loc)[1], bootstrap_cost(Cellulitis_PO_min_prices_corrected, Cellulitis_PO_loc)[2])
Freq_CI_costreport[6, 2:3] <- CI95Print(bootstrap_cost(Cellulitis_IV_min_prices_corrected, Cellulitis_IV_loc)[1], bootstrap_cost(Cellulitis_IV_min_prices_corrected, Cellulitis_IV_loc)[2])
Freq_CI_costreport
cheapest_isrecc(CAP_PO_min_prices_corrected, CAP_PO_loc)
bootstrap_cost(CAP_PO_min_prices_corrected, CAP_PO_loc)
bootstrap_cost(CAP_IV_min_prices_corrected, CAP_IV_loc)
bootstrap_cost(UTI_PO_min_prices_corrected, UTI_PO_loc)
bootstrap_cost(UTI_IV_min_prices_corrected, UTI_IV_loc)
bootstrap_cost(Cellulitis_PO_min_prices_corrected, Cellulitis_PO_loc)
bootstrap_cost(Cellulitis_IV_min_prices_corrected, Cellulitis_IV_loc)
CI95Print <- function(means, stdevs){
return(c((means - (qnorm(0.975)*stdevs/sqrt(1000))), (means + (qnorm(0.975)*stdevs/sqrt(1000)))))
}
CI95Print(bootstrap_cost(CAP_PO_min_prices_corrected, CAP_PO_loc)[1], bootstrap_cost(CAP_PO_min_prices_corrected, CAP_PO_loc)[2])
CI95Print(bootstrap_cost(CAP_IV_min_prices_corrected, CAP_IV_loc)[1], bootstrap_cost(CAP_IV_min_prices_corrected, CAP_IV_loc)[2])
CI95Print(bootstrap_cost(UTI_PO_min_prices_corrected, UTI_PO_loc)[1], bootstrap_cost(UTI_PO_min_prices_corrected, UTI_PO_loc)[2])
CI95Print(bootstrap_cost(UTI_IV_min_prices_corrected, UTI_IV_loc)[1], bootstrap_cost(UTI_IV_min_prices_corrected, UTI_IV_loc)[2])
CI95Print(bootstrap_cost(Cellulitis_PO_min_prices_corrected, Cellulitis_PO_loc)[1], bootstrap_cost(Cellulitis_PO_min_prices_corrected, Cellulitis_PO_loc)[2])
CI95Print(bootstrap_cost(Cellulitis_IV_min_prices_corrected, Cellulitis_IV_loc)[1], bootstrap_cost(Cellulitis_IV_min_prices_corrected, Cellulitis_IV_loc)[2])
# Make matrix to display data
Freq_CI_costreport <- matrix(0, 6, 3)
rownames(Freq_CI_costreport) <- c("CAP PO", "CAP IV", "UTI PO", "UTI IV", "Cellulitis PO", "Cellulitis IV")
colnames(Freq_CI_costreport) <- c("Frequency of Cheapest Antibiotic Recommendation", "CI", "CI")
Freq_CI_costreport[1,1] <- cheapest_isrecc(CAP_PO_min_prices_corrected, CAP_PO_loc)
Freq_CI_costreport[2,1] <- cheapest_isrecc(CAP_IV_min_prices_corrected, CAP_IV_loc)
Freq_CI_costreport[3,1] <- cheapest_isrecc(UTI_PO_min_prices_corrected, UTI_PO_loc)
Freq_CI_costreport[4,1] <- cheapest_isrecc(UTI_IV_min_prices_corrected, UTI_IV_loc)
Freq_CI_costreport[5,1] <- cheapest_isrecc(Cellulitis_PO_min_prices_corrected, Cellulitis_PO_loc)
Freq_CI_costreport[6,1] <- cheapest_isrecc(Cellulitis_IV_min_prices_corrected, Cellulitis_IV_loc)
Freq_CI_costreport[1, 2:3] <- CI95Print(bootstrap_cost(CAP_PO_min_prices_corrected, CAP_PO_loc)[1], bootstrap_cost(CAP_PO_min_prices_corrected, CAP_PO_loc)[2])
Freq_CI_costreport[2, 2:3] <- CI95Print(bootstrap_cost(CAP_IV_min_prices_corrected, CAP_IV_loc)[1], bootstrap_cost(CAP_IV_min_prices_corrected, CAP_IV_loc)[2])
Freq_CI_costreport[3, 2:3] <- CI95Print(bootstrap_cost(UTI_PO_min_prices_corrected, UTI_PO_loc)[1], bootstrap_cost(UTI_PO_min_prices_corrected, UTI_PO_loc)[2])
Freq_CI_costreport[4, 2:3] <- CI95Print(bootstrap_cost(UTI_IV_min_prices_corrected, UTI_IV_loc)[1], bootstrap_cost(UTI_IV_min_prices_corrected, UTI_IV_loc)[2])
Freq_CI_costreport[5, 2:3] <- CI95Print(bootstrap_cost(Cellulitis_PO_min_prices_corrected, Cellulitis_PO_loc)[1], bootstrap_cost(Cellulitis_PO_min_prices_corrected, Cellulitis_PO_loc)[2])
Freq_CI_costreport[6, 2:3] <- CI95Print(bootstrap_cost(Cellulitis_IV_min_prices_corrected, Cellulitis_IV_loc)[1], bootstrap_cost(Cellulitis_IV_min_prices_corrected, Cellulitis_IV_loc)[2])
Freq_CI_costreport
pheatmap((CAP_PO - min_prices_CAP_PO), display_numbers=1, kmeans_k=NA, cluster_rows=0, cluster_cols=0, na_col="gray", angle_col=45, color = colorRampPalette(c(green_colors[1], green_colors[13]))(13),
#main="Differential between Hospital's Cheapest PO Antibiotic and Other CAP Treatment Recommendations",
cellwidth=60, cellheight=60, labels_row=c("CAD ($)","CAD ($)","EUR (€)", "ZAR (R)", "USD ($)", "USD ($)", "USD ($)"), number_color="black", fontsize_number=12)
CAP_PO_min_prices_corrected
CAP_IV - min_prices_CAP_IV
UTI_PO - min_prices_UTI_PO
UTI_IV - min_prices_UTI_IV
Cellulitis_PO - min_prices_Cellulitis_PO
Cellulitis_IV - min_prices_Cellulitis_IV
Cellulitis_PO - min_prices_Cellulitis_PO
pheatmap((CAP_PO - min_prices_CAP_PO), display_numbers=1, kmeans_k=NA, cluster_rows=0, cluster_cols=0, na_col="gray", angle_col=45, color = colorRampPalette(c(green_colors[1], green_colors[13]))(13),
#main="Differential between Hospital's Cheapest PO Antibiotic and Other CAP Treatment Recommendations",
cellwidth=60, cellheight=60, labels_row=c("Canada","Canada","Ireland", "South Africa", "U.S.", "U.S.", "U.S."), number_color="black", fontsize_number=12)
green_colors <-print(colorRampPalette(c(greens[1], greens[9]))(100))
pheatmap((CAP_PO - min_prices_CAP_PO), display_numbers=1, kmeans_k=NA, cluster_rows=0, cluster_cols=0, na_col="gray", angle_col=45, color = colorRampPalette(c(green_colors[1], green_colors[13]))(13),
#main="Differential between Hospital's Cheapest PO Antibiotic and Other CAP Treatment Recommendations",
cellwidth=60, cellheight=60, labels_row=c("Canada","Canada","Ireland", "South Africa", "U.S.", "U.S.", "U.S."), number_color="black", fontsize_number=12)
#pheatmap((CAP_IV - min_prices_CAP_IV), display_numbers=1, kmeans_k=NA, cluster_rows=0, cluster_cols=0, na_col="gray", angle_col=45, color = colorRampPalette(c("white", "forestgreen"))(100), main="Delta of Hospital's Cheapest IV Antibiotic from Alternative CAP Treatment Recommendations", cellwidth=60, cellheight=60, colnames=c("CAN $","EUR (€)", "ZAR (R)", "USD $"))
pheatmap((CAP_IV - min_prices_CAP_IV), display_numbers=1, kmeans_k=NA, cluster_rows=0, cluster_cols=0, na_col="gray", angle_col=45, color = colorRampPalette(c(green_colors[1], green_colors[100]))(100),
#main="Differential between Hospital's Cheapest IV Antibiotic and Other CAP Treatment Recommendations",
cellwidth=60, cellheight=60, labels_row=c("Canada","Ireland", "South Africa", "U.S."), number_color="black", fontsize_number=12)
pheatmap((UTI_PO - min_prices_UTI_PO), display_numbers=1, kmeans_k=NA, cluster_rows=0, cluster_cols=0, na_col="gray", angle_col=45, color = colorRampPalette(c(green_colors[1], green_colors[12]))(12),
#main="Differential between Hospital's Cheapest PO Antibiotic and Other UTI Treatment Recommendations",
cellwidth=60, cellheight=60, labels_row=c("Canada","Canada","Ireland", "South Africa", "U.S."), number_color="black", fontsize_number=12)
pheatmap((UTI_IV - min_prices_UTI_IV), display_numbers=1, kmeans_k=NA, cluster_rows=0, cluster_cols=0, na_col="gray", angle_col=45, color = colorRampPalette(c(green_colors[1], green_colors[50]))(50),
#main="Differential between Hospital's Cheapest IV Antibiotic and Other UTI Treatment Recommendations",
cellwidth=60, cellheight=60, labels_row=c("Canada", "Ireland", "South Africa", "U.S."), number_color="black", fontsize_number=12)
pheatmap((Cellulitis_PO - min_prices_Cellulitis_PO), display_numbers=1, kmeans_k=NA, cluster_rows=0, cluster_cols=0, na_col="gray", angle_col=45, color = colorRampPalette(c(green_colors[1], green_colors[4]))(4),
#main="Differential between Hospital's Cheapest PO Antibiotic and Other Cellulitis Treatment Recommendations",
cellwidth=60, cellheight=60, labels_row=c("Canada", "Ireland", "South Africa", "U.S.", "U.S."), number_color="black", fontsize_number=12)
pheatmap((Cellulitis_IV - min_prices_Cellulitis_IV), display_numbers=1, kmeans_k=NA, cluster_rows=0, cluster_cols=0, na_col="gray", angle_col=45, color = colorRampPalette(c(green_colors[1], green_colors[100]))(100),
#main="Differential between Hospital's Cheapest IV Antibiotic and Other Cellulitis Treatment Recommendations",
cellwidth=60, cellheight=60, labels_row=c("Canada", "Ireland", "South Africa", "U.S.", "U.S."), number_color="black", fontsize_number=12)
?pheatmap
pheatmap((Cellulitis_IV - min_prices_Cellulitis_IV), display_numbers=1, kmeans_k=NA, cluster_rows=0, cluster_cols=0, na_col="gray", angle_col=45, color = colorRampPalette(c(green_colors[1], green_colors[100]))(100),
#main="Differential between Hospital's Cheapest IV Antibiotic and Other Cellulitis Treatment Recommendations",
cellwidth=60, cellheight=60, labels_row=c("Canada", "Ireland", "South Africa", "U.S.", "U.S."), number_color=c(rep("black",6), rep("white",2), rep("black", 22)), fontsize_number=12)
pheatmap((Cellulitis_IV - min_prices_Cellulitis_IV), display_numbers=1, kmeans_k=NA, cluster_rows=0, cluster_cols=0, na_col="gray", angle_col=45, color = colorRampPalette(c(green_colors[1], green_colors[100]))(100),
#main="Differential between Hospital's Cheapest IV Antibiotic and Other Cellulitis Treatment Recommendations",
cellwidth=60, cellheight=60, labels_row=c("Canada", "Ireland", "South Africa", "U.S.", "U.S."), number_color=c("black", "white", rep("black",4), "white", rep("black",23)), fontsize_number=12)
pheatmap((Cellulitis_PO - min_prices_Cellulitis_PO), display_numbers=1, kmeans_k=NA, cluster_rows=0, cluster_cols=0, na_col="gray", angle_col=45, color = colorRampPalette(c(green_colors[1], green_colors[4]))(4),
#main="Differential between Hospital's Cheapest PO Antibiotic and Other Cellulitis Treatment Recommendations",
cellwidth=60, cellheight=60, labels_row=c("Canada", "Ireland", "South Africa", "U.S.", "U.S."), number_color="black", fontsize_number=12)
pheatmap((UTI_IV - min_prices_UTI_IV), display_numbers=1, kmeans_k=NA, cluster_rows=0, cluster_cols=0, na_col="gray", angle_col=45, color = colorRampPalette(c(green_colors[1], green_colors[50]))(50),
#main="Differential between Hospital's Cheapest IV Antibiotic and Other UTI Treatment Recommendations",
cellwidth=60, cellheight=60, labels_row=c("Canada", "Ireland", "South Africa", "U.S."), number_color="black", fontsize_number=12)
pheatmap((UTI_PO - min_prices_UTI_PO), display_numbers=1, kmeans_k=NA, cluster_rows=0, cluster_cols=0, na_col="gray", angle_col=45, color = colorRampPalette(c(green_colors[1], green_colors[12]))(12),
#main="Differential between Hospital's Cheapest PO Antibiotic and Other UTI Treatment Recommendations",
cellwidth=60, cellheight=60, labels_row=c("Canada","Canada","Ireland", "South Africa", "U.S."), number_color="black", fontsize_number=12)
#pheatmap((CAP_IV - min_prices_CAP_IV), display_numbers=1, kmeans_k=NA, cluster_rows=0, cluster_cols=0, na_col="gray", angle_col=45, color = colorRampPalette(c("white", "forestgreen"))(100), main="Delta of Hospital's Cheapest IV Antibiotic from Alternative CAP Treatment Recommendations", cellwidth=60, cellheight=60, colnames=c("CAN $","EUR (€)", "ZAR (R)", "USD $"))
pheatmap((CAP_IV - min_prices_CAP_IV), display_numbers=1, kmeans_k=NA, cluster_rows=0, cluster_cols=0, na_col="gray", angle_col=45, color = colorRampPalette(c(green_colors[1], green_colors[100]))(100),
#main="Differential between Hospital's Cheapest IV Antibiotic and Other CAP Treatment Recommendations",
cellwidth=60, cellheight=60, labels_row=c("Canada","Ireland", "South Africa", "U.S."), number_color="black", fontsize_number=12)
pheatmap((CAP_PO - min_prices_CAP_PO), display_numbers=1, kmeans_k=NA, cluster_rows=0, cluster_cols=0, na_col="gray", angle_col=45, color = colorRampPalette(c(green_colors[1], green_colors[13]))(13),
#main="Differential between Hospital's Cheapest PO Antibiotic and Other CAP Treatment Recommendations",
cellwidth=60, cellheight=60, labels_row=c("Canada","Canada","Ireland", "South Africa", "U.S.", "U.S.", "U.S."), number_color="black", fontsize_number=12)
#pheatmap((CAP_IV - min_prices_CAP_IV), display_numbers=1, kmeans_k=NA, cluster_rows=0, cluster_cols=0, na_col="gray", angle_col=45, color = colorRampPalette(c("white", "forestgreen"))(100), main="Delta of Hospital's Cheapest IV Antibiotic from Alternative CAP Treatment Recommendations", cellwidth=60, cellheight=60, colnames=c("CAN $","EUR (€)", "ZAR (R)", "USD $"))
pheatmap((CAP_IV - min_prices_CAP_IV), display_numbers=1, kmeans_k=NA, cluster_rows=0, cluster_cols=0, na_col="gray", angle_col=45, color = colorRampPalette(c(green_colors[1], green_colors[100]))(100),
#main="Differential between Hospital's Cheapest IV Antibiotic and Other CAP Treatment Recommendations",
cellwidth=60, cellheight=60, labels_row=c("Canada","Ireland", "South Africa", "U.S."), number_color="black", fontsize_number=12)
#pheatmap((CAP_IV - min_prices_CAP_IV), display_numbers=1, kmeans_k=NA, cluster_rows=0, cluster_cols=0, na_col="gray", angle_col=45, color = colorRampPalette(c("white", "forestgreen"))(100), main="Delta of Hospital's Cheapest IV Antibiotic from Alternative CAP Treatment Recommendations", cellwidth=60, cellheight=60, colnames=c("CAN $","EUR (€)", "ZAR (R)", "USD $"))
pheatmap((CAP_IV - min_prices_CAP_IV), display_numbers=1, kmeans_k=NA, cluster_rows=0, cluster_cols=0, na_col="gray", angle_col=45, color = colorRampPalette(c(green_colors[1], green_colors[100]))(100),
#main="Differential between Hospital's Cheapest IV Antibiotic and Other CAP Treatment Recommendations",
cellwidth=60, cellheight=60, labels_row=c("Canada","Ireland", "South Africa", "U.S."), number_color=c(rep("black",5), "white", rep("black", 22)), fontsize_number=12)
pheatmap((UTI_IV - min_prices_UTI_IV), display_numbers=1, kmeans_k=NA, cluster_rows=0, cluster_cols=0, na_col="gray", angle_col=45, color = colorRampPalette(c(green_colors[1], green_colors[50]))(50),
#main="Differential between Hospital's Cheapest IV Antibiotic and Other UTI Treatment Recommendations",
cellwidth=60, cellheight=60, labels_row=c("Canada", "Ireland", "South Africa", "U.S."), number_color="black", fontsize_number=12)
pheatmap((Cellulitis_PO - min_prices_Cellulitis_PO), display_numbers=1, kmeans_k=NA, cluster_rows=0, cluster_cols=0, na_col="gray", angle_col=45, color = colorRampPalette(c(green_colors[1], green_colors[4]))(4),
#main="Differential between Hospital's Cheapest PO Antibiotic and Other Cellulitis Treatment Recommendations",
cellwidth=60, cellheight=60, labels_row=c("Canada", "Ireland", "South Africa", "U.S.", "U.S."), number_color="black", fontsize_number=12)
pheatmap((UTI_IV - min_prices_UTI_IV), display_numbers=1, kmeans_k=NA, cluster_rows=0, cluster_cols=0, na_col="gray", angle_col=45, color = colorRampPalette(c(green_colors[1], green_colors[50]))(50),
#main="Differential between Hospital's Cheapest IV Antibiotic and Other UTI Treatment Recommendations",
cellwidth=60, cellheight=60, labels_row=c("Canada", "Ireland", "South Africa", "U.S."), number_color="black", fontsize_number=12)
pheatmap((UTI_PO - min_prices_UTI_PO), display_numbers=1, kmeans_k=NA, cluster_rows=0, cluster_cols=0, na_col="gray", angle_col=45, color = colorRampPalette(c(green_colors[1], green_colors[12]))(12),
#main="Differential between Hospital's Cheapest PO Antibiotic and Other UTI Treatment Recommendations",
cellwidth=60, cellheight=60, labels_row=c("Canada","Canada","Ireland", "South Africa", "U.S."), number_color="black", fontsize_number=12)
#pheatmap((CAP_IV - min_prices_CAP_IV), display_numbers=1, kmeans_k=NA, cluster_rows=0, cluster_cols=0, na_col="gray", angle_col=45, color = colorRampPalette(c("white", "forestgreen"))(100), main="Delta of Hospital's Cheapest IV Antibiotic from Alternative CAP Treatment Recommendations", cellwidth=60, cellheight=60, colnames=c("CAN $","EUR (€)", "ZAR (R)", "USD $"))
pheatmap((CAP_IV - min_prices_CAP_IV), display_numbers=1, kmeans_k=NA, cluster_rows=0, cluster_cols=0, na_col="gray", angle_col=45, color = colorRampPalette(c(green_colors[1], green_colors[100]))(100),
#main="Differential between Hospital's Cheapest IV Antibiotic and Other CAP Treatment Recommendations",
cellwidth=60, cellheight=60, labels_row=c("Canada","Ireland", "South Africa", "U.S."), number_color=c(rep("black",5), "white", rep("black", 22)), fontsize_number=12)
pheatmap((CAP_PO - min_prices_CAP_PO), display_numbers=1, kmeans_k=NA, cluster_rows=0, cluster_cols=0, na_col="gray", angle_col=45, color = colorRampPalette(c(green_colors[1], green_colors[13]))(13),
#main="Differential between Hospital's Cheapest PO Antibiotic and Other CAP Treatment Recommendations",
cellwidth=60, cellheight=60, labels_row=c("Canada","Canada","Ireland", "South Africa", "U.S.", "U.S.", "U.S."), number_color="black", fontsize_number=12)
pheatmap((UTI_IV - min_prices_UTI_IV), display_numbers=1, kmeans_k=NA, cluster_rows=0, cluster_cols=0, na_col="gray", angle_col=45, color = colorRampPalette(c(green_colors[1], green_colors[50]))(50),
#main="Differential between Hospital's Cheapest IV Antibiotic and Other UTI Treatment Recommendations",
cellwidth=60, cellheight=60, labels_row=c("Canada", "Ireland", "South Africa", "U.S."), number_color="black", fontsize_number=12)
pheatmap((UTI_PO - min_prices_UTI_PO), display_numbers=1, kmeans_k=NA, cluster_rows=0, cluster_cols=0, na_col="gray", angle_col=45, color = colorRampPalette(c(green_colors[1], green_colors[12]))(12),
#main="Differential between Hospital's Cheapest PO Antibiotic and Other UTI Treatment Recommendations",
cellwidth=60, cellheight=60, labels_row=c("Canada","Canada","Ireland", "South Africa", "U.S."), number_color="black", fontsize_number=12)
#pheatmap((CAP_IV - min_prices_CAP_IV), display_numbers=1, kmeans_k=NA, cluster_rows=0, cluster_cols=0, na_col="gray", angle_col=45, color = colorRampPalette(c("white", "forestgreen"))(100), main="Delta of Hospital's Cheapest IV Antibiotic from Alternative CAP Treatment Recommendations", cellwidth=60, cellheight=60, colnames=c("CAN $","EUR (€)", "ZAR (R)", "USD $"))
pheatmap((CAP_IV - min_prices_CAP_IV), display_numbers=1, kmeans_k=NA, cluster_rows=0, cluster_cols=0, na_col="gray", angle_col=45, color = colorRampPalette(c(green_colors[1], green_colors[100]))(100),
#main="Differential between Hospital's Cheapest IV Antibiotic and Other CAP Treatment Recommendations",
cellwidth=60, cellheight=60, labels_row=c("Canada","Ireland", "South Africa", "U.S."), number_color=c(rep("black",5), "white", rep("black", 22)), fontsize_number=12)
pheatmap((UTI_PO - min_prices_UTI_PO), display_numbers=1, kmeans_k=NA, cluster_rows=0, cluster_cols=0, na_col="gray", angle_col=45, color = colorRampPalette(c(green_colors[1], green_colors[12]))(12),
#main="Differential between Hospital's Cheapest PO Antibiotic and Other UTI Treatment Recommendations",
cellwidth=60, cellheight=60, labels_row=c("Canada","Canada","Ireland", "South Africa", "U.S."), number_color="black", fontsize_number=12)
pheatmap((UTI_IV - min_prices_UTI_IV), display_numbers=1, kmeans_k=NA, cluster_rows=0, cluster_cols=0, na_col="gray", angle_col=45, color = colorRampPalette(c(green_colors[1], green_colors[50]))(50),
#main="Differential between Hospital's Cheapest IV Antibiotic and Other UTI Treatment Recommendations",
cellwidth=60, cellheight=60, labels_row=c("Canada", "Ireland", "South Africa", "U.S."), number_color="black", fontsize_number=12)
pheatmap((Cellulitis_PO - min_prices_Cellulitis_PO), display_numbers=1, kmeans_k=NA, cluster_rows=0, cluster_cols=0, na_col="gray", angle_col=45, color = colorRampPalette(c(green_colors[1], green_colors[4]))(4),
#main="Differential between Hospital's Cheapest PO Antibiotic and Other Cellulitis Treatment Recommendations",
cellwidth=60, cellheight=60, labels_row=c("Canada", "Ireland", "South Africa", "U.S.", "U.S."), number_color="black", fontsize_number=12)
pheatmap((Cellulitis_IV - min_prices_Cellulitis_IV), display_numbers=1, kmeans_k=NA, cluster_rows=0, cluster_cols=0, na_col="gray", angle_col=45, color = colorRampPalette(c(green_colors[1], green_colors[100]))(100),
#main="Differential between Hospital's Cheapest IV Antibiotic and Other Cellulitis Treatment Recommendations",
cellwidth=60, cellheight=60, labels_row=c("Canada", "Ireland", "South Africa", "U.S.", "U.S."), number_color=c("black", "white", rep("black",4), "white", rep("black",23)), fontsize_number=12)
m
CAP_PO
CAP_PO
CAP_IV
UTI_PO
UTI_IV
Cellulitis_PO
Cellulitis_IV
uniq(rownames(Cellulitis_IV))
unique(rownames(Cellulitis_IV))
unique(rownames(Cellulitis_IV), rownames(Cellulits_PO), rownames(UTI_PO), rownames(UTI_IV), rownames(CAP_IV), rownames(CAP_PO))
r <- read_excel("~/Desktop/DBMI/Research/AntibioticRxGuidelinesAnalysis/Cost_Antibiotics/Cost_AntibioticsinGuidelines_AntibioticsofInterest.v5.xlsx")
conversion_canada <- 0.75
conversion_euro <- 1.14
conversion_rand <- 0.073
m <- as.matrix(r[,-1])
rownames(m) <- r[[1]]
#m[is.na(m)] <- 0
# m <- m[,-which(colSums(m)==0)]
# m <- m[which(rowSums(m)==0),]
# remove rows with no data; rowSums==0
m <- m[-c(8,13,17,21,24),]
## CAP
# remove hospitals that do not make a recommendation
m <- m[-c(10,11,15,18,19,20,21,8,9),]
CAP <- m[,-c(3:4,6:11,13:15,17:20,22,24:26,28:29,31:36,38:45)]
CAP_PO <- CAP[c(1,2,4,6, 8, 10, 12),]
CAP_IV <- CAP[c(3,5,7,9,11),]
CAP_IV <- CAP_IV[-5,]
# Convert currencies to USD
CAP_PO[1,] <- CAP_PO[1,]*conversion_canada
CAP_PO[2,] <- CAP_PO[2,]*conversion_canada
CAP_PO[3,] <- CAP_PO[3,]*conversion_euro
CAP_PO[4,] <- CAP_PO[4,]*conversion_rand
CAP_IV[1,] <- CAP_IV[1,]*conversion_canada
CAP_IV[2,] <- CAP_IV[2,]*conversion_euro
CAP_IV[3,] <- CAP_IV[3,]*conversion_rand
#CAP_PO <- CAP_PO[-7,]
#### Remove inappropriate routes of administration:
# remove Ceftriaxone, penicillin G from PO because only administered as IV
CAP_PO <- CAP_PO[,c(-4, -10)]
# remove amoxicillin, amox/clav from IV because only PO
CAP_IV <- CAP_IV[,c(-1,-2)]
# remove clarithromycin
CAP_IV <- CAP_IV[,c(-3)]
#find the minimum cost to later be subtracted from each option
min_prices_CAP_PO <-apply(CAP_PO, 1, FUN = function(x) {min(x[is.na(x)==F])})
min_prices_CAP_IV <-apply(CAP_IV, 1, FUN = function(x) {min(x[is.na(x)==F])})
### UTI
#columns are antibiotics, rows are hospitals
m <- as.matrix(r[,-1])
rownames(m) <- r[[1]]
UTI <- m[-c(10:16,18,19,8,9),-c(1,3:9,11:13,16:31,33:39,41:43,45)]
UTI[1,] <- UTI[1,]*conversion_canada
UTI[2,] <- UTI[2,]*conversion_canada
UTI[3,] <- UTI[3,]*conversion_canada
UTI[4,] <- UTI[4,]*conversion_euro
UTI[5,] <- UTI[5,]*conversion_euro
UTI[6,] <- UTI[6,]*conversion_rand
UTI[7,] <- UTI[7,]*conversion_rand
UTI_PO <- UTI[c(1,2,4,6,9),]
UTI_IV <- UTI[c(3,5,7,15),]
# remove pip/tazo from UTI PO
UTI_PO <- UTI_PO[,-6]
# remove amox/clav, cefpodoxime, cephalexin, nitrofurantoin from UTI_IV
UTI_IV <- UTI_IV[,c(-1, -2, -3, -5)]
min_prices_UTI_PO <-apply(UTI_PO, 1, FUN = function(x) {min(x[is.na(x)==F])})
min_prices_UTI_IV <-apply(UTI_IV, 1, FUN = function(x) {min(x[is.na(x)==F])})
## Cellulitis
#Cellulitis <- m[-c(8,13,17,21,24),]
Cellulitis <- m[c(2:3,4:5,6:7,14:17, 25:26), c(7,14, 16, 18, 20, 24, 35, 37)]
Cellulitis[1,] <- Cellulitis[1,]*conversion_canada
Cellulitis[2,] <- Cellulitis[2,]*conversion_canada
Cellulitis[3,] <- Cellulitis[3,]*conversion_euro
Cellulitis[4,] <- Cellulitis[4,]*conversion_euro
Cellulitis[5,] <- Cellulitis[5,]*conversion_rand
Cellulitis[6,] <- Cellulitis[6,]*conversion_rand
Cellulitis_PO <- Cellulitis[c(1,3,5,7,9),]
Cellulitis_IV <- Cellulitis[c(2,4,6,8,12),]
#Cellulitis_PO <- Cellulitis_PO[-which(rowSums(Cellulitis_PO)==0),]
# remove cefazolin, penicillin G, oxacillin because no PO
Cellulitis_PO <- Cellulitis_PO[,c(-1,-7,-8)]
# remove cephalexin, dicloxacillin because no IV
Cellulitis_IV <- Cellulitis_IV[,c(-2,-5)]
min_prices_Cellulitis_PO <-apply(Cellulitis_PO, 1, FUN = function(x) {min(x[is.na(x)==F])})
min_prices_Cellulitis_IV <-apply(Cellulitis_IV, 1, FUN = function(x) {min(x[is.na(x)==F])})
#install.packages("pheatmap")
library(pheatmap)
library(RColorBrewer)
greens <- brewer.pal(9, "Greens")
green_colors <-print(colorRampPalette(c(greens[1], greens[9]))(100))
# 100 <- 300
# with old row labels
#pheatmap((CAP_PO - min_prices_CAP_PO), display_numbers=1, kmeans_k=NA, cluster_rows=0, cluster_cols=0, na_col="gray", angle_col=45, color = colorRampPalette(c("white", "forestgreen"))(100), main="Delta of Hospital's Cheapest PO Antibiotic from Alternative CAP Treatment Recommendations", cellwidth=60, cellheight=60)
pheatmap((CAP_PO - min_prices_CAP_PO), display_numbers=1, kmeans_k=NA, cluster_rows=0, cluster_cols=0, na_col="gray", angle_col=45, color = colorRampPalette(c(green_colors[1], green_colors[13]))(13),
#main="Differential between Hospital's Cheapest PO Antibiotic and Other CAP Treatment Recommendations",
cellwidth=60, cellheight=60, labels_row=c("Canada","Canada","Ireland", "South Africa", "U.S.", "U.S.", "U.S."), number_color="black", fontsize_number=12)
#pheatmap((CAP_IV - min_prices_CAP_IV), display_numbers=1, kmeans_k=NA, cluster_rows=0, cluster_cols=0, na_col="gray", angle_col=45, color = colorRampPalette(c("white", "forestgreen"))(100), main="Delta of Hospital's Cheapest IV Antibiotic from Alternative CAP Treatment Recommendations", cellwidth=60, cellheight=60, colnames=c("CAN $","EUR (€)", "ZAR (R)", "USD $"))
pheatmap((CAP_IV - min_prices_CAP_IV), display_numbers=1, kmeans_k=NA, cluster_rows=0, cluster_cols=0, na_col="gray", angle_col=45, color = colorRampPalette(c(green_colors[1], green_colors[100]))(100),
#main="Differential between Hospital's Cheapest IV Antibiotic and Other CAP Treatment Recommendations",
cellwidth=60, cellheight=60, labels_row=c("Canada","Ireland", "South Africa", "U.S."), number_color=c(rep("black",5), "white", rep("black", 22)), fontsize_number=12)
pheatmap((UTI_PO - min_prices_UTI_PO), display_numbers=1, kmeans_k=NA, cluster_rows=0, cluster_cols=0, na_col="gray", angle_col=45, color = colorRampPalette(c(green_colors[1], green_colors[12]))(12),
#main="Differential between Hospital's Cheapest PO Antibiotic and Other UTI Treatment Recommendations",
cellwidth=60, cellheight=60, labels_row=c("Canada","Canada","Ireland", "South Africa", "U.S."), number_color="black", fontsize_number=12)
pheatmap((UTI_IV - min_prices_UTI_IV), display_numbers=1, kmeans_k=NA, cluster_rows=0, cluster_cols=0, na_col="gray", angle_col=45, color = colorRampPalette(c(green_colors[1], green_colors[50]))(50),
#main="Differential between Hospital's Cheapest IV Antibiotic and Other UTI Treatment Recommendations",
cellwidth=60, cellheight=60, labels_row=c("Canada", "Ireland", "South Africa", "U.S."), number_color="black", fontsize_number=12)
pheatmap((Cellulitis_PO - min_prices_Cellulitis_PO), display_numbers=1, kmeans_k=NA, cluster_rows=0, cluster_cols=0, na_col="gray", angle_col=45, color = colorRampPalette(c(green_colors[1], green_colors[4]))(4),
#main="Differential between Hospital's Cheapest PO Antibiotic and Other Cellulitis Treatment Recommendations",
cellwidth=60, cellheight=60, labels_row=c("Canada", "Ireland", "South Africa", "U.S.", "U.S."), number_color="black", fontsize_number=12)
pheatmap((Cellulitis_IV - min_prices_Cellulitis_IV), display_numbers=1, kmeans_k=NA, cluster_rows=0, cluster_cols=0, na_col="gray", angle_col=45, color = colorRampPalette(c(green_colors[1], green_colors[100]))(100),
#main="Differential between Hospital's Cheapest IV Antibiotic and Other Cellulitis Treatment Recommendations",
cellwidth=60, cellheight=60, labels_row=c("Canada", "Ireland", "South Africa", "U.S.", "U.S."), number_color=c("black", "white", rep("black",4), "white", rep("black",23)), fontsize_number=12)
CAP_PO_min_prices_corrected <- CAP_PO - min_prices_CAP_PO # max is 12.75
CAP_IV_min_prices_corrected <- CAP_IV - min_prices_CAP_IV # max is 296.4
UTI_PO_min_prices_corrected <- UTI_PO - min_prices_UTI_PO # max is 11.55
UTI_IV_min_prices_corrected <- UTI_IV - min_prices_UTI_IV # max is 50
Cellulitis_PO_min_prices_corrected <- Cellulitis_PO - min_prices_Cellulitis_PO # max is 3.76
Cellulitis_IV_min_prices_corrected <- Cellulitis_IV - min_prices_Cellulitis_IV # max is 273.6
# Frequency of min drug selected calculation
CAP_PO_loc <- vector("list", 20)
# locations of antibiotic recommendations
CAP_PO_loc[[1]] <- c(1, 4)
CAP_PO_loc[[2]] <- c(1, 5)
CAP_PO_loc[[3]] <- c(2, 3)
CAP_PO_loc[[4]] <- c(2, 5)
CAP_PO_loc[[5]] <- c(3, 1)
CAP_PO_loc[[6]] <- c(3, 2)
CAP_PO_loc[[7]] <- c(3, 4)
CAP_PO_loc[[8]] <- c(4, 1)
CAP_PO_loc[[9]] <- c(4, 4)
CAP_PO_loc[[10]] <- c(5, 3)
CAP_PO_loc[[11]] <- c(5, 5)
CAP_PO_loc[[12]] <- c(5, 8)
CAP_PO_loc[[13]] <- c(6, 3)
CAP_PO_loc[[14]] <- c(6, 5)
CAP_PO_loc[[15]] <- c(6, 8)
CAP_PO_loc[[16]] <- c(7, 3)
CAP_PO_loc[[17]] <- c(7, 4)
CAP_PO_loc[[18]] <- c(7, 5)
CAP_PO_loc[[19]] <- c(7, 6)
CAP_PO_loc[[20]] <- c(7, 7)
CAP_IV_loc <- vector("list", 9)
CAP_IV_loc[[1]] <- c(1,1)
CAP_IV_loc[[2]] <- c(1,2)
CAP_IV_loc[[3]] <- c(1,3)
CAP_IV_loc[[4]] <- c(3,2)
CAP_IV_loc[[5]] <- c(3,7)
CAP_IV_loc[[6]] <- c(4,1)
CAP_IV_loc[[7]] <- c(4,2)
CAP_IV_loc[[8]] <- c(4,3)
CAP_IV_loc[[9]] <- c(4,6)
UTI_PO_loc <- vector("list", 12)
UTI_PO_loc[[1]] <- c(1,5)
UTI_PO_loc[[2]] <- c(1,6)
UTI_PO_loc[[3]] <- c(2,4)
UTI_PO_loc[[4]] <- c(2,5)
UTI_PO_loc[[5]] <- c(2,6)
UTI_PO_loc[[6]] <- c(3,5)
UTI_PO_loc[[7]] <- c(4,1)
UTI_PO_loc[[8]] <- c(4,4)
UTI_PO_loc[[9]] <- c(5,2)
UTI_PO_loc[[10]] <- c(5,3)
UTI_PO_loc[[11]] <- c(5,5)
UTI_PO_loc[[12]] <- c(5,6)
UTI_IV_loc <- vector("list", 5)
UTI_IV_loc[[1]] <- c(1,1)
UTI_IV_loc[[2]] <- c(1,3)
UTI_IV_loc[[3]] <- c(2,2)
UTI_IV_loc[[4]] <- c(3,1)
UTI_IV_loc[[5]] <- c(4,3)
Cellulitis_PO_loc <- vector("list", 9)
Cellulitis_PO_loc[[1]] <- c(1,1)
Cellulitis_PO_loc[[2]] <- c(1,2)
Cellulitis_PO_loc[[3]] <- c(1,3)
Cellulitis_PO_loc[[4]] <- c(2,5)
Cellulitis_PO_loc[[5]] <- c(3,3)
Cellulitis_PO_loc[[6]] <- c(4,1)
Cellulitis_PO_loc[[7]] <- c(4,4)
Cellulitis_PO_loc[[8]] <- c(5,1)
Cellulitis_PO_loc[[9]] <- c(5,4)
Cellulitis_IV_loc <- vector("list", 7)
Cellulitis_IV_loc[[1]] <- c(1,2)
Cellulitis_IV_loc[[2]] <- c(1,3)
Cellulitis_IV_loc[[3]] <- c(2,4)
Cellulitis_IV_loc[[4]] <- c(2,6)
Cellulitis_IV_loc[[5]] <- c(3,3)
Cellulitis_IV_loc[[6]] <- c(5,1)
Cellulitis_IV_loc[[7]] <- c(5,5)
# Calculates how frequently the antibiotic recommendation is the cheapest available option to that hospital
cheapest_isrecc <- function(costmatrix, recclocationlist){
cheapests <- c(rep(0, length(recclocationlist)))
for (i in seq(1:length(cheapests))){
cheapests[i] <- as.numeric(costmatrix[recclocationlist[[i]][1], recclocationlist[[i]][2]]==0)
}
cheapests[which(is.na(cheapests))] <- 0
freq_cheapest_selection <- sum(cheapests)/length(cheapests)
return(freq_cheapest_selection)
}
# For the matrices with the cheapest drug subtracted from each drug
cheapest_isrecc(CAP_PO_min_prices_corrected, CAP_PO_loc)
cheapest_isrecc(CAP_IV_min_prices_corrected, CAP_IV_loc)
cheapest_isrecc(UTI_PO_min_prices_corrected, UTI_PO_loc)
cheapest_isrecc(UTI_IV_min_prices_corrected, UTI_IV_loc)
cheapest_isrecc(Cellulitis_PO_min_prices_corrected, Cellulitis_PO_loc)
cheapest_isrecc(Cellulitis_IV_min_prices_corrected, Cellulitis_IV_loc)
# To calculate the frequency of all diagnoses and MOAs combined, return cheapests from cheapest_isrecc and run:
sum(cheapest_isrecc(CAP_PO_min_prices_corrected, CAP_PO_loc), cheapest_isrecc(CAP_IV_min_prices_corrected, CAP_IV_loc), cheapest_isrecc(UTI_PO_min_prices_corrected, UTI_PO_loc), cheapest_isrecc(UTI_IV_min_prices_corrected, UTI_IV_loc), cheapest_isrecc(Cellulitis_PO_min_prices_corrected, Cellulitis_PO_loc), cheapest_isrecc(Cellulitis_IV_min_prices_corrected, Cellulitis_IV_loc)) / (length(cheapest_isrecc(CAP_PO_min_prices_corrected, CAP_PO_loc))+length(cheapest_isrecc(CAP_IV_min_prices_corrected, CAP_IV_loc))+ length(cheapest_isrecc(UTI_PO_min_prices_corrected, UTI_PO_loc)) + length(cheapest_isrecc(UTI_IV_min_prices_corrected, UTI_IV_loc)) + length(cheapest_isrecc(Cellulitis_PO_min_prices_corrected, Cellulitis_PO_loc)) + length(cheapest_isrecc(Cellulitis_IV_min_prices_corrected, Cellulitis_IV_loc)))
# Bootstrapping
# Sample from each row with replacement
bootstrap_cost <- function(costmatrix, recclocationlist){
bootstraps <- rep(0, 1000)
# For each bootstrap:
for (i in seq(1:1000)){
cost_sim <- matrix(0, dim(costmatrix)[1], dim(costmatrix)[2])
# For simulating each row:
for (j in seq(1:dim(costmatrix)[1])){
cost_sim[j,] <- sample(costmatrix[j,], size=dim(costmatrix)[2], replace=T)
}
bootstraps[i] <- cheapest_isrecc(cost_sim, recclocationlist)
}
return(c(mean(bootstraps), sd(bootstraps)))
}
bootstrap_cost(CAP_PO_min_prices_corrected, CAP_PO_loc)
bootstrap_cost(CAP_IV_min_prices_corrected, CAP_IV_loc)
bootstrap_cost(UTI_PO_min_prices_corrected, UTI_PO_loc)
bootstrap_cost(UTI_IV_min_prices_corrected, UTI_IV_loc)
bootstrap_cost(Cellulitis_PO_min_prices_corrected, Cellulitis_PO_loc)
bootstrap_cost(Cellulitis_IV_min_prices_corrected, Cellulitis_IV_loc)
CI95Print <- function(means, stdevs){
return(c((means - (qnorm(0.975)*stdevs/sqrt(1000))), (means + (qnorm(0.975)*stdevs/sqrt(1000)))))
}
CI95Print(bootstrap_cost(CAP_PO_min_prices_corrected, CAP_PO_loc)[1], bootstrap_cost(CAP_PO_min_prices_corrected, CAP_PO_loc)[2])
CI95Print(bootstrap_cost(CAP_IV_min_prices_corrected, CAP_IV_loc)[1], bootstrap_cost(CAP_IV_min_prices_corrected, CAP_IV_loc)[2])
CI95Print(bootstrap_cost(UTI_PO_min_prices_corrected, UTI_PO_loc)[1], bootstrap_cost(UTI_PO_min_prices_corrected, UTI_PO_loc)[2])
CI95Print(bootstrap_cost(UTI_IV_min_prices_corrected, UTI_IV_loc)[1], bootstrap_cost(UTI_IV_min_prices_corrected, UTI_IV_loc)[2])
CI95Print(bootstrap_cost(Cellulitis_PO_min_prices_corrected, Cellulitis_PO_loc)[1], bootstrap_cost(Cellulitis_PO_min_prices_corrected, Cellulitis_PO_loc)[2])
CI95Print(bootstrap_cost(Cellulitis_IV_min_prices_corrected, Cellulitis_IV_loc)[1], bootstrap_cost(Cellulitis_IV_min_prices_corrected, Cellulitis_IV_loc)[2])
# Make matrix to display data
Freq_CI_costreport <- matrix(0, 6, 3)
rownames(Freq_CI_costreport) <- c("CAP PO", "CAP IV", "UTI PO", "UTI IV", "Cellulitis PO", "Cellulitis IV")
colnames(Freq_CI_costreport) <- c("Frequency of Cheapest Antibiotic Recommendation", "CI", "CI")
Freq_CI_costreport[1,1] <- cheapest_isrecc(CAP_PO_min_prices_corrected, CAP_PO_loc)
Freq_CI_costreport[2,1] <- cheapest_isrecc(CAP_IV_min_prices_corrected, CAP_IV_loc)
Freq_CI_costreport[3,1] <- cheapest_isrecc(UTI_PO_min_prices_corrected, UTI_PO_loc)
Freq_CI_costreport[4,1] <- cheapest_isrecc(UTI_IV_min_prices_corrected, UTI_IV_loc)
Freq_CI_costreport[5,1] <- cheapest_isrecc(Cellulitis_PO_min_prices_corrected, Cellulitis_PO_loc)
Freq_CI_costreport[6,1] <- cheapest_isrecc(Cellulitis_IV_min_prices_corrected, Cellulitis_IV_loc)
Freq_CI_costreport[1, 2:3] <- CI95Print(bootstrap_cost(CAP_PO_min_prices_corrected, CAP_PO_loc)[1], bootstrap_cost(CAP_PO_min_prices_corrected, CAP_PO_loc)[2])
Freq_CI_costreport[2, 2:3] <- CI95Print(bootstrap_cost(CAP_IV_min_prices_corrected, CAP_IV_loc)[1], bootstrap_cost(CAP_IV_min_prices_corrected, CAP_IV_loc)[2])
Freq_CI_costreport[3, 2:3] <- CI95Print(bootstrap_cost(UTI_PO_min_prices_corrected, UTI_PO_loc)[1], bootstrap_cost(UTI_PO_min_prices_corrected, UTI_PO_loc)[2])
Freq_CI_costreport[4, 2:3] <- CI95Print(bootstrap_cost(UTI_IV_min_prices_corrected, UTI_IV_loc)[1], bootstrap_cost(UTI_IV_min_prices_corrected, UTI_IV_loc)[2])
Freq_CI_costreport[5, 2:3] <- CI95Print(bootstrap_cost(Cellulitis_PO_min_prices_corrected, Cellulitis_PO_loc)[1], bootstrap_cost(Cellulitis_PO_min_prices_corrected, Cellulitis_PO_loc)[2])
Freq_CI_costreport[6, 2:3] <- CI95Print(bootstrap_cost(Cellulitis_IV_min_prices_corrected, Cellulitis_IV_loc)[1], bootstrap_cost(Cellulitis_IV_min_prices_corrected, Cellulitis_IV_loc)[2])
unique(rownames(Cellulitis_IV), rownames(Cellulits_PO), rownames(UTI_PO), rownames(UTI_IV), rownames(CAP_IV), rownames(CAP_PO))
unique(rownames(Cellulitis_IV), rownames(Cellulitis_PO), rownames(UTI_PO), rownames(UTI_IV), rownames(CAP_IV), rownames(CAP_PO))
unique(rownames(Cellulitis_IV), rownames(Cellulitis_PO), rownames(UTI_PO), rownames(UTI_IV), rownames(CAP_IV), rownames(CAP_PO), fromLAST=T)
unique(rownames(Cellulitis_IV), rownames(Cellulitis_PO), rownames(UTI_PO), rownames(UTI_IV), rownames(CAP_IV), rownames(CAP_PO), fromLast=T)
unique(rownames(Cellulitis_IV), rownames(Cellulitis_PO), rownames(UTI_PO), rownames(UTI_IV), rownames(CAP_IV), rownames(CAP_PO), fromLast=F)
unique(c(rownames(Cellulitis_IV), rownames(Cellulitis_PO), rownames(UTI_PO), rownames(UTI_IV), rownames(CAP_IV), rownames(CAP_PO)), fromLast=F)
unique(c(rownames(Cellulitis_IV), rownames(Cellulitis_PO), rownames(UTI_PO), rownames(UTI_IV), rownames(CAP_IV), rownames(CAP_PO)))
#--- Loading helper files
loadlibs = function(libs) {
for(lib in libs) {
class(lib)
if(!do.call(require,as.list(lib))) {install.packages(lib)}
do.call(require,as.list(lib))
}
}
libs = c("tidyr","magrittr","purrr","dplyr","stringr","readr","data.table", "mice",
"randomForest", "ada", "gbm", "caret", "e1071", "ROCR", "ggplot2", "glmnet", "readxl",
"survival", "fastDummies")
loadlibs(libs)
#--- Loading helper files
loadlibs = function(libs) {
for(lib in libs) {
class(lib)
if(!do.call(require,as.list(lib))) {install.packages(lib)}
do.call(require,as.list(lib))
}
}
libs = c("tidyr","magrittr","purrr","dplyr","stringr","readr","data.table", "mice",
"randomForest", "ada", "gbm", "caret", "e1071", "ROCR", "ggplot2", "glmnet", "readxl",
"survival", "fastDummies")
loadlibs(libs)
summary(dem %>% mutate_if(is.character, as.factor))
libs = c("tidyr","magrittr","purrr","dplyr","stringr","readr","data.table", "mice",
"randomForest", "ada", "gbm", "caret", "e1071", "ROCR", "ggplot2", "glmnet", "readxl",
"survival", "fastDummies")
loadlibs(libs)
mode_fun <- function(x) {
ux <- unique(x)
ux[which.max(tabulate(match(x, ux)))]
}
#--- setting global decimal print setting
options(scipen=4)
prog = fread("program_activity.csv") %>% as_tibble()
dem = fread("demographic.csv") %>% as_tibble()
presc = fread("opiate_prescription_fills.csv") %>% as_tibble()
#--- Loading helper files
loadlibs = function(libs) {
for(lib in libs) {
class(lib)
if(!do.call(require,as.list(lib))) {install.packages(lib)}
do.call(require,as.list(lib))
}
}
libs = c("tidyr","magrittr","purrr","dplyr","stringr","readr","data.table", "mice",
"randomForest", "ada", "gbm", "caret", "e1071", "ROCR", "ggplot2", "glmnet", "readxl",
"survival", "fastDummies")
loadlibs(libs)
mode_fun <- function(x) {
ux <- unique(x)
ux[which.max(tabulate(match(x, ux)))]
}
#--- setting global decimal print setting
options(scipen=4)
prog = fread("program_activity.csv") %>% as_tibble()
dem = fread("demographic.csv") %>% as_tibble()
presc = fread("opiate_prescription_fills.csv") %>% as_tibble()
install.packages(lib)
